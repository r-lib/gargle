<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Load a user-provided token — credentials_byo_oauth2 • gargle</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Load a user-provided token — credentials_byo_oauth2"><meta name="description" content="This function is designed to pass its token input through, after doing a
few checks and some light processing:
If token has class request, i.e. it is a token that has been prepared
with httr::config(), the auth_token component is extracted. For
example, such input could be returned by googledrive::drive_token()
or bigrquery::bq_token().
If token is an instance of Gargle2.0 (so: a gargle-obtained user
token), checks that it appears to be a Google OAuth token, based on its
embedded oauth_endpoint. Refreshes the token, if it's refreshable.
Returns the token.


There is no point in providing scopes. They are ignored because the
scopes associated with the token have already been baked in to the token
itself and gargle does not support incremental authorization. The main point
of credentials_byo_oauth2() is to allow token_fetch() (and packages that
wrap it) to accommodate a &quot;bring your own token&quot; workflow.
This also makes it possible to obtain a token with one package and then
register it for use with another package. For example, the default scope
requested by googledrive is also sufficient for operations available in
googlesheets4. You could use a shared token like so:
library(googledrive)
library(googlesheets4)
drive_auth(email = &quot;jane_doe@example.com&quot;)
gs4_auth(token = drive_token())
# work with both packages freely now, with the same identity
"><meta property="og:description" content="This function is designed to pass its token input through, after doing a
few checks and some light processing:
If token has class request, i.e. it is a token that has been prepared
with httr::config(), the auth_token component is extracted. For
example, such input could be returned by googledrive::drive_token()
or bigrquery::bq_token().
If token is an instance of Gargle2.0 (so: a gargle-obtained user
token), checks that it appears to be a Google OAuth token, based on its
embedded oauth_endpoint. Refreshes the token, if it's refreshable.
Returns the token.


There is no point in providing scopes. They are ignored because the
scopes associated with the token have already been baked in to the token
itself and gargle does not support incremental authorization. The main point
of credentials_byo_oauth2() is to allow token_fetch() (and packages that
wrap it) to accommodate a &quot;bring your own token&quot; workflow.
This also makes it possible to obtain a token with one package and then
register it for use with another package. For example, the default scope
requested by googledrive is also sufficient for operations available in
googlesheets4. You could use a shared token like so:
library(googledrive)
library(googlesheets4)
drive_auth(email = &quot;jane_doe@example.com&quot;)
gs4_auth(token = drive_token())
# work with both packages freely now, with the same identity
"><script src="https://cdn.jsdelivr.net/gh/posit-dev/supported-by-posit/js/badge.min.js" data-max-height="43" data-light-bg="#666f76" data-light-fg="#f9f9f9"></script><script defer data-domain="gargle.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gargle</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.6.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/non-interactive-auth.html">Non-interactive auth</a></li>
    <li><a class="dropdown-item" href="../articles/troubleshooting.html">Troubleshooting gargle auth</a></li>
    <li><a class="dropdown-item" href="../articles/auth-from-web.html">Auth when using R from the browser</a></li>
    <li><a class="dropdown-item" href="../articles/get-api-credentials.html">How to get your own API credentials</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2021/07/gargle-1-2-0/">gargle 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2019/08/gargle-hello-world/">gargle's debut on CRAN</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/gargle/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Load a user-provided token</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/gargle/blob/main/R/credentials_byo_oauth2.R" class="external-link"><code>R/credentials_byo_oauth2.R</code></a></small>
      <div class="d-none name"><code>credentials_byo_oauth2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is designed to pass its <code>token</code> input through, after doing a
few checks and some light processing:</p><ul><li><p>If <code>token</code> has class <code>request</code>, i.e. it is a token that has been prepared
with <code><a href="https://httr.r-lib.org/reference/config.html" class="external-link">httr::config()</a></code>, the <code>auth_token</code> component is extracted. For
example, such input could be returned by <code>googledrive::drive_token()</code>
or <code>bigrquery::bq_token()</code>.</p></li>
<li><p>If <code>token</code> is an instance of <code>Gargle2.0</code> (so: a gargle-obtained user
token), checks that it appears to be a Google OAuth token, based on its
embedded <code>oauth_endpoint</code>. Refreshes the token, if it's refreshable.</p></li>
<li><p>Returns the <code>token</code>.</p></li>
</ul><p>There is no point in providing <code>scopes</code>. They are ignored because the
<code>scopes</code> associated with the token have already been baked in to the token
itself and gargle does not support incremental authorization. The main point
of <code>credentials_byo_oauth2()</code> is to allow <code><a href="token_fetch.html">token_fetch()</a></code> (and packages that
wrap it) to accommodate a "bring your own token" workflow.</p>
<p>This also makes it possible to obtain a token with one package and then
register it for use with another package. For example, the default scope
requested by googledrive is also sufficient for operations available in
googlesheets4. You could use a shared token like so:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(googledrive)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(googlesheets4)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">drive_auth</span>(<span class="at">email =</span> <span class="st">"jane_doe@example.com"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">gs4_auth</span>(<span class="at">token =</span> <span class="fu">drive_token</span>())</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co"># work with both packages freely now, with the same identity</span></span></code></pre><p></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">credentials_byo_oauth2</span><span class="op">(</span>scopes <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">token</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-scopes">scopes<a class="anchor" aria-label="anchor" href="#arg-scopes"></a></dt>
<dd><p>A character vector of scopes to request. Pick from those listed
at <a href="https://developers.google.com/identity/protocols/oauth2/scopes" class="external-link">https://developers.google.com/identity/protocols/oauth2/scopes</a>.</p>
<p>For certain token flows, the
<code>"https://www.googleapis.com/auth/userinfo.email"</code> scope is unconditionally
included. This grants permission to retrieve the email address associated
with a token; gargle uses this to index cached OAuth tokens. This grants no
permission to view or send email and is generally considered a low-value
scope.</p></dd>


<dt id="arg-token">token<a class="anchor" aria-label="anchor" href="#arg-token"></a></dt>
<dd><p>A token with class <a href="https://httr.r-lib.org/reference/Token-class.html" class="external-link">Token2.0</a> or an object of
httr's class <code>request</code>, i.e. a token that has been prepared with
<code><a href="https://httr.r-lib.org/reference/config.html" class="external-link">httr::config()</a></code> and has a <a href="https://httr.r-lib.org/reference/Token-class.html" class="external-link">Token2.0</a> in the
<code>auth_token</code> component.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to all credential functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <a href="https://httr.r-lib.org/reference/Token-class.html" class="external-link">Token2.0</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other credential functions:
<code><a href="credentials_app_default.html">credentials_app_default()</a></code>,
<code><a href="credentials_external_account.html">credentials_external_account()</a></code>,
<code><a href="credentials_gce.html">credentials_gce()</a></code>,
<code><a href="credentials_service_account.html">credentials_service_account()</a></code>,
<code><a href="credentials_user_oauth2.html">credentials_user_oauth2()</a></code>,
<code><a href="token_fetch.html">token_fetch()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># assume `my_token` is a Token2.0 object returned by a function such as</span></span></span>
<span class="r-in"><span><span class="co"># credentials_user_oauth2()</span></span></span>
<span class="r-in"><span><span class="fu">credentials_byo_oauth2</span><span class="op">(</span>token <span class="op">=</span> <span class="va">my_token</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://jennybryan.org" class="external-link">Jennifer Bryan</a>, Craig Citro, <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

  </div></footer></body></html>

